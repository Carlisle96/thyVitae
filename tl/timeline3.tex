\documentclass[11pt,a4paper]{article}   
\usepackage[utf8]{inputenc}     
\usepackage{xifthen}
\usepackage{calc}
\renewcommand*\familydefault{\sfdefault}    
\usepackage[T1]{fontenc}
\usepackage[top=2cm, bottom=2cm, left=1cm, right=1cm]{geometry}     
\usepackage{setspace}

\usepackage{array}
% custom column width
\newcolumntype{x}[1]{%
>{\raggedleft\hspace{0pt}}p{#1}}%
\usepackage{graphicx}
\usepackage{wrapfig}
% for drawing graphics and charts
\usepackage{tikz}
\usetikzlibrary{shapes, backgrounds}
\usepackage{color}
\definecolor{maincol}{RGB}{255,150,0} %main color
\definecolor{bgcol}{RGB}{255,255,255}  %background color
\definecolor{textcol}{RGB}{0,0,0}%textcolor

\definecolor{thyFirst}{RGB}{132,70,132}
\definecolor{thySecond}{RGB}{70,70,132}
\definecolor{thyThird}{RGB}{132,70,70}

\pagecolor{bgcol}


\setlength{\parindent}{0pt}
\usepackage{parskip}

\newcounter{yearcount}
\newcounter{leftcount}

% env cvtimeline
%
% creates a vertical cv timeline
%
% param 1: start year
% param 2: end year
% param 3: overall height
% param 4: width of textboxes       {\parbox{\myboxwidth}
\newenvironment{cvtimeline}[4]{

    % creates a stretched box as cv entry headline followed by two paragraphs about
    % the work you did
    % param 1:  event start month/year
    % param 2:  event end month/year
    % param 3:  event name
    % param 4:  color
    % param 5: level (position, use minus for left placement)
    % param 6: grey text
    \newcommand{\cvMidEvent}[6]{
        \foreach \monthf/\yearf in {##1} {
            \foreach \montht/\yeart in {##2} {
                \pgfmathparse{#3/\fullrange*((\yearf-#1)+(\monthf/12))}
                \let\startexp\pgfmathresult
                \pgfmathparse{#3/\fullrange*((\yeart-#1)+(\montht/12))}
                \let\endexp\pgfmathresult
                \pgfmathparse{0.5*\endexp+0.5*\startexp}
                \let\midexp\pgfmathresult

                \filldraw[fill=##4, draw=none, opacity=1]
                    (-0.15-##5,\startexp)
                        rectangle
                    (-0.15-##5-0.2,\endexp);

                \draw[draw=##4, line width=1.5pt] (0, \midexp) -- (0.8,\midexp);

                \node[label={
                    [label distance=-2]0:\colorbox{##4}{\footnotesize\strut}
                    \colorbox{bgcol}{
                            \parbox{#4}{\setstretch{1.0}\footnotesize\ifthenelse{\equal{##6}{}}{\textcolor{textcol}{##3}}{\textcolor{gray}{##6} \textcolor{textcol}{##3}}}
                    }
                }] at (0.5, \midexp) {};
            }
            \addtocounter{leftcount}{1}
        }
    }

    % param 1:  event month/year
    % param 2:  event name
    \newcommand{\cvEvent}[2]{
        \foreach \monthf/\yearf in {##1} {
            \pgfmathparse{#3/\fullrange*((\yearf-#1)+(\monthf/12))}
            \let\startexp\pgfmathresult

            \draw[draw=thyThird, line width=1.5pt] (0, \startexp) -- (0.8,\startexp);

            \node[label={
                [label distance=-2]0:\colorbox{thyThird}{\footnotesize\strut}
                \colorbox{bgcol}{
                     \parbox{#4}{\setstretch{1.0}\footnotesize\textcolor{gray}{##1} \textcolor{textcol}{##2}}
                    }
            }] at (0.5, \startexp) {};

            \addtocounter{leftcount}{1}
        }
    }
    
    \newcommand{\cvAtEvent}[7]{
        \foreach \monthf/\yearf in {##1} {
            \foreach \montht/\yeart in {##2} {
                \foreach \montha/\yeara in {##7} {
                    \pgfmathparse{#3/\fullrange*((\yearf-#1)+(\monthf/12))}
                    \let\startexp\pgfmathresult
                    \pgfmathparse{#3/\fullrange*((\yeart-#1)+(\montht/12))}
                    \let\endexp\pgfmathresult
                    \pgfmathparse{0.5*\endexp+0.5*\startexp}
                    \let\midexp\pgfmathresult
                    \pgfmathparse{#3/\fullrange*((\yeara-#1)+(\montha/12))}
                    \let\atexp\pgfmathresult

                    \filldraw[fill=##4, draw=none, opacity=1]
                        (-0.15-##5,\startexp)
                            rectangle
                        (-0.15-##5-0.2,\endexp);

                    \draw[draw=##4, line width=1.5pt] (0, \atexp) -- (0.8,\atexp);

                    \node[label={
                        [label distance=-2]0:\colorbox{##4}{\footnotesize\strut}
                        \colorbox{bgcol}{
                            \parbox{#4}{\setstretch{1.0}\footnotesize\ifthenelse{\equal{##6}{}}{\textcolor{textcol}{##3}}{\textcolor{gray}{##6} \textcolor{textcol}{##3}}}
                        }
                    }] at (0.5, \atexp) {};
                }
            }
            \addtocounter{leftcount}{1}
        }
    }



    %--------------------------------------------------------------------------------------
    %   BEGIN
    %--------------------------------------------------------------------------------------

    \begin{tikzpicture}
        \setcounter{leftcount}{1}
        %calc fullrange= number of years
        \pgfmathparse{(#2-#1)}
        \let\fullrange\pgfmathresult
        \pgfmathparse{\year}
        \let\testa\pgfmathresult
        \pgfmathparse{#3/\fullrange*((\year-#1)+(\month/12))}
        \let\todayexp\pgfmathresult
        \draw[draw=textcol, line width=3pt] (0,0) -- (0,\todayexp);
        \draw[draw=textcol, dashed, line width=2pt] (0,\todayexp) -- (0,#3);
        %the timeline
        %for each year put a  line in place
        \setcounter{yearcount}{1}
        \whiledo{\value{yearcount} < \fullrange}{
            %\draw[fill=white,draw=textcol, line width=1pt]  (0,#3/\fullrange*\value{yearcount}) circle (0.07);
            \draw[draw=textcol, line width=1pt] (0,#3/\fullrange*\value{yearcount}) -- (0.2,#3/\fullrange*\value{yearcount});
            \stepcounter{yearcount}
        }
        \draw[draw=textcol, line width=2pt] (0,0) -- (1,0);
        \draw[draw=textcol, dashed, line width=2pt] (0,#3) -- (1,#3);
        %start year
        %\filldraw[fill=white!100,draw=textcol,line width=3pt] (0,-0.5) circle (0.5);
        %\node[label=\textcolor{textcol}{\textbf{#1}}] at (0.6,0) {};
        \node[label=\textcolor{textcol}{\textbf{2023}}] at (0.6,#3-0.7) {};
        %end year
        %\filldraw[fill=white!100,draw=textcol,line width=3pt] (0,#3+0.75) circle (1);
        %\node[label=\textcolor{textcol}{\textbf{\large\}}] at (0,#3+0.42) {};
}%end begin part of newenv

{\end{tikzpicture}}








\begin{document}
% TIMELINE
\begin{cvtimeline}{2010}{2024}{20}{0.18\linewidth}


\cvMidEvent{9/2020}{4/2022}{Technical \\ Accountant}{thySecond}{0.5}{}
\cvMidEvent{3/2018}{4/2018}{Web Developer}{thySecond}{0.5}{}
\cvAtEvent{6/2017}{11/2017}{Technical Specialist}{thySecond}{0.5}{}{9/2017}
\cvMidEvent{1/2014}{5/2017}{Self-employed}{thySecond}{0.5}{}
\cvMidEvent{4/2011}{9/2013}{Energy and \\ Process Engineering}{thyFirst}{0.1}{}
\cvAtEvent{10/2013}{3/2017}{B.Sc. \\ Computer Science}{thyFirst}{0.1}{3/2017}{2/2017}
\cvAtEvent{4/2017}{3/2023}{M.Sc. \\ Computer Science}{thyFirst}{0.1}{3/2023}{2/2023}


\cvEvent{6/2010}{high-school\\ diploma}
\cvAtEvent{8/2010}{1/2011}{Assistant \\ in surgical ward}{thySecond}{0.5}{}{1/2011}
\end{cvtimeline}
\end{document}
